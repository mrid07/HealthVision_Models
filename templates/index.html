<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>rPPG Realtime Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="container">

    <h1>Realtime rPPG Monitoring</h1>

    <div style="text-align: center; margin-bottom: 20px;">
        <a href="/math-stress" style="color: #3b82f6; text-decoration: none; font-size: 1.1em; border: 1px solid #3b82f6; padding: 8px 16px; border-radius: 6px; transition: all 0.2s;">Go to Stress Test (Math) &rarr;</a>
    </div>

    <!-- Controls -->
    <div class="controls">
        <input type="text" id="userName" placeholder="Enter Name" style="padding: 10px; border-radius: 6px; border: 1px solid #ccc;">
        <button id="startBtn">Start</button>
        <button id="stopBtn">Stop</button>
    </div>
    
    <div id="feedback" class="feedback"></div>

    <!-- Video -->
    <div class="video-box">
        <img id="videoFeed" src="" alt="Camera Feed (optional)">
        <div class="video-placeholder">
            Camera feed handled by backend (producer)
        </div>
    </div>

    <!-- Metrics -->
    <div class="metrics">
        <div class="metric"><span>HR</span><p id="hr">--</p></div>
        <div class="metric"><span>RR</span><p id="rr">--</p></div>
        <div class="metric"><span>BP (Old)</span><p id="bp">--/--</p></div>
        <div class="metric"><span>BP (New)</span><p id="bp_new">--/--</p></div>
        <div class="metric"><span>SQI</span><p id="sqi">--</p></div>
    </div>
    
    <div class="analysis">
        <div class="metric"><span>Stress</span><p id="stress_label">--</p></div>
        <div class="metric"><span>Calmness</span><p id="calmness">--</p></div>
    </div>

    <!-- Charts -->
    <div class="charts-container">
        <!-- BP Models Side by Side -->
        <div class="chart-row">
            <div class="chart-box">
                <canvas id="bpChart"></canvas>
            </div>
            <div class="chart-box">
                <canvas id="bpNewChart"></canvas>
            </div>
        </div>
        <!-- Heart Rate Below -->
        <div class="chart-row-full">
            <div class="chart-box">
                <canvas id="hrChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Session Summary -->
    <div id="sessionSummary" class="session-summary" style="display: none;">
        <h2>Session Summary</h2>
        <div class="summary-cards">
            <div class="summary-card">
                <h3>Average Heart Rate</h3>
                <p id="avgHr" class="summary-value" style="color: #f43f5e;">-- bpm</p>
            </div>
            <div class="summary-card">
                <h3>Average BP (Old Model)</h3>
                <p id="avgBpOld" class="summary-value" style="color: #ef4444;">--/-- mmHg</p>
            </div>
            <div class="summary-card">
                <h3>Average BP (New Model)</h3>
                <p id="avgBpNew" class="summary-value" style="color: #10b981;">--/-- mmHg</p>
            </div>
        </div>
    </div>

    <!-- Debug -->
    <div class="debug">
        <h3>Debug State</h3>
        <pre id="debugBox">Waiting for data...</pre>
    </div>

</div>

<script src="/static/app.js"></script>
</body>
</html>
